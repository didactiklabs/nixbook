# manifest.yaml
name: witr Update
scms:
  default:
    kind: 'github'
    spec:
      email: 'updatecli@didactiklabs.io'
      owner: 'didactiklabs'
      repository: 'nixbook'
      token: '{{ requiredEnv "UPDATECLI_GITHUB_TOKEN" }}'
      username: '{{ requiredEnv "GITHUB_ACTOR" }}'
      branch: 'main'
# Defines how to get "source" information such as Jenkins version
sources:
  default:
    name: Get latest release from GitHub
    kind: githubrelease
    spec:
      owner: pranshuparmar
      repository: witr
      token: '{{ requiredEnv "UPDATECLI_GITHUB_TOKEN" }}'
      username: '{{ requiredEnv "GITHUB_ACTOR" }}'
# Defines "conditions" required to update targets
conditions: {}
# Defines "targets" which need to be updated if different than "source" information.
targets:
  default:
    name: witr npins update
    kind: shell
    scmid: 'default'
    spec:
      environments:
        - name: PATH
      command: nix run nixpkgs/nixos-unstable#npins -- update witr
      files:
        - npins/sources.json
# Define action configurations if one needs to be created
actions:
  default:
    kind: 'github/pullrequest'
    scmid: 'default'
    spec:
      mergemethod: 'rebase'
      automerge: true
      description: 'Update witr npins.'
      draft: false
      title: 'UPDATECLI: Update witr'
