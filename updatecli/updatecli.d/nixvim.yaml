# manifest.yaml
name: nixvim Update
scms:
  default:
    kind: "github"
    spec:
      email: "updatecli@didactiklabs.io"
      owner: "didactiklabs"
      repository: "nixbook"
      token: '{{ requiredEnv "UPDATECLI_GITHUB_TOKEN" }}'
      username: '{{ requiredEnv "GITHUB_ACTOR" }}'
      branch: "main"
# Defines how to get "source" information such as Jenkins version
sources:
  default:
    name: Get latest revision from GitHub
    kind: shell
    spec:
      command: git ls-remote https://github.com/nix-community/nixvim main | awk '{print $1}' | head -n 1
# Defines "conditions" required to update targets
conditions: {}
# Defines "targets" which need to be updated if different than "source" information.
targets:
  default:
    name: nixvim npins update
    kind: shell
    scmid: "default"
    spec:
      environments:
        - name: PATH
      command: nix run nixpkgs/nixos-unstable#npins -- update nixvim
      files:
        - npins/sources.json
# Define action configurations if one needs to be created
actions:
  default:
    kind: "github/pullrequest"
    scmid: "default"
    spec:
      mergemethod: "rebase"
      automerge: true
      description: "Update nixvim npins."
      draft: false
      title: "UPDATECLI: Update nixvim"
